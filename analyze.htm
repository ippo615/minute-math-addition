<!DOCTYPE html>
<html >
<head>
	<meta charset="UTF-8">
	<title>Random Addition</title>
	<meta name="author" content="Andrew Ippoliti">

	<!-- IN ANDROID BROWSER - enter "about:debug" in the address bar
	     It should give you some extra options and a 'js console' -->

	<!-- Mobile viewport optimization http://goo.gl/b9SaQ -->
	<meta name="HandheldFriendly" content="True">
	<meta name="MobileOptimized" content="320">
	<!--<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=10.0;">-->
	<!--<meta name="viewport" content="width=device-width, height=device-height, user-scalable=no" />-->
	<!-- Force the browser to use 320x320 as the viewport size -->
	<!--<meta name="viewport" content="width=320, height=320, user-scalable=no" />-->
	<!-- Force the browser to use the device width as the viewport with -->
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	
	<!-- Hide browser chrome (iOS only) -->
	<meta name="apple-mobile-web-app-capable" content="yes" />

	<!-- Supposedly style the status bar -->
	<meta name="apple-mobile-web-app-status-bar-style" content="black" />
	
	<link rel="stylesheet" href="styles.css" />

</head>
<body>

    <div id="game-content" >
	<div class="question transition" id="question" >Begin</div>
	<div class="answer transition " id="choice-1" >-</div>
	<div class="answer transition " id="choice-2">-</div>
	<div class="answer transition " id="choice-3">-</div>
	<div class="answer transition " id="choice-4">-</div>
    </div>

<script type="text/javascript" src="js-lib-data.js"></script>
<script type="text/javascript" src="js-lib-generic.js"></script>
<script type="text/javascript">
function setupTransitions(timer,time,transitions,action){
	// fade everything out:
	timer.pushEvent( function(){ addClass( document.getElementById('choice-4'), transitions[4] ) }, time );
	timer.pushEvent( function(){ addClass( document.getElementById('choice-3'), transitions[3] ) }, time );
	timer.pushEvent( function(){ addClass( document.getElementById('choice-2'), transitions[2] ) }, time );
	timer.pushEvent( function(){ addClass( document.getElementById('choice-1'), transitions[1] ) }, time );
	timer.pushEvent( function(){ addClass( document.getElementById('question'), transitions[0] ) }, time );
	// change everything
	timer.pushEvent( function(){
		document.getElementById('choice-4').className = "answer transition " + transitions[4];
		document.getElementById('choice-3').className = "answer transition " + transitions[3];
		document.getElementById('choice-2').className = "answer transition " + transitions[2];
		document.getElementById('choice-1').className = "answer transition " + transitions[1];
		document.getElementById('question').className = "question transition " + transitions[0];
		// makeQuestion(100,999);
		action();
	}, time/2);
	// fade everything back in
	timer.pushEvent( function(){ removeClass( document.getElementById('question'), transitions[0] ) }, time );
	timer.pushEvent( function(){ removeClass( document.getElementById('choice-1'), transitions[1] ) }, time );
	timer.pushEvent( function(){ removeClass( document.getElementById('choice-2'), transitions[2] ) }, time );
	timer.pushEvent( function(){ removeClass( document.getElementById('choice-3'), transitions[3] ) }, time );
	timer.pushEvent( function(){ removeClass( document.getElementById('choice-4'), transitions[4] ) }, time );
	// run it
	timer.process();
}
function showSessionStatsAnalisys(){
	// show stats
	var c4 = document.getElementById('choice-4');
	var c3 = document.getElementById('choice-3');
	var c2 = document.getElementById('choice-2');
	var c1 = document.getElementById('choice-1');
	var q0 = document.getElementById('question');
	q0.innerHTML = 'Last';
	c1.innerHTML = '<span class="stat" >Right: '+nRight1+'</span>';
	c2.innerHTML = '<span class="stat" >Wrong: '+(nRight2+nRight3+nRight4+nSkipped)+'</span>';
	c3.innerHTML = '<span class="stat" >+'+nExp+' exp</span>';
	c4.innerHTML = '<span class="stat" >Erase</span>';
	q0.onclick = function(){
		setupTransitions(timer,GLOBAL.animDelay,getRandomElementFrom(transitions),showTotalStatsAnalisys);
	};
}
function showTotalStatsAnalisys(){
	var c4 = document.getElementById('choice-4');
	var c3 = document.getElementById('choice-3');
	var c2 = document.getElementById('choice-2');
	var c1 = document.getElementById('choice-1');
	var q0 = document.getElementById('question');
	q0.innerHTML = 'Total';
	c1.innerHTML = '<span class="stat" >Right: '+nTotalRight1+'</span>';
	c2.innerHTML = '<span class="stat" >Wrong: '+(nTotalRight2+nTotalRight3+nTotalRight4+nTotalSkipped)+'</span>';
	c3.innerHTML = '<span class="stat" >'+nTotalExp+' exp</span>';
	c4.innerHTML = '<span class="stat" >Erase</span>';
	q0.onclick = function(){
		setupTransitions(timer,GLOBAL.animDelay,getRandomElementFrom(transitions),showSessionStatsAnalisys);
	};
}
var transitions = [
	["outRight","outRight","outRight","outRight","outRight"], // slide right
	["outDown","outDown","outDown","outDown","outDown"], // slide down
	["outDown","outLeft","outLeft","outRight","outRight"], // slide right/left
	["outFade","outFade","outFade","outFade","outFade"] // fade
];

function erase(){
	// data.clearAll(); // doesnt work on android - so just save everything as 0

	data.save('nTotalAsked',0);
	data.save('nTotalRight1',0);
	data.save('nTotalRight2',0);
	data.save('nTotalRight3',0);
	data.save('nTotalRight4',0);
	data.save('nTotalSkipped',0);
	data.save('nTotalExp',0);
	data.save('nAsked',0);
	data.save('nRight1',0);
	data.save('nRight2',0);
	data.save('nRight3',0);
	data.save('nRight4',0);
	data.save('nSkipped',0);
	data.save('nExp',0);

	nTotalAsked = data.loadValid('nTotalAsked',0,data.int10);
	nTotalRight1 = data.loadValid('nTotalRight1',0,data.int10);
	nTotalRight2 = data.loadValid('nTotalRight2',0,data.int10);
	nTotalRight3 = data.loadValid('nTotalRight3',0,data.int10);
	nTotalRight4 = data.loadValid('nTotalRight4',0,data.int10);
	nTotalSkipped = data.loadValid('nTotalSkipped',0,data.int10);
	nTotalExp = data.loadValid('nTotalExp',0,data.int10);
	nAsked = data.loadValid('nAsked',0,data.int10);
	nRight1 = data.loadValid('nRight1',0,data.int10);
	nRight2 = data.loadValid('nRight2',0,data.int10);
	nRight3 = data.loadValid('nRight3',0,data.int10);
	nRight4 = data.loadValid('nRight4',0,data.int10);
	nSkipped = data.loadValid('nSkipped',0,data.int10);
	nExp = data.loadValid('nExp',0,data.int10);

	showTotalStatsAnalisys();
}

var isAnsweredCorrectly = 0;
var nAttempts = 0;
var baseExp = 0;
// Totals for every time played
var nTotalAsked = data.loadValid('nTotalAsked',0,data.int10);
var nTotalRight1 = data.loadValid('nTotalRight1',0,data.int10);
var nTotalRight2 = data.loadValid('nTotalRight2',0,data.int10);
var nTotalRight3 = data.loadValid('nTotalRight3',0,data.int10);
var nTotalRight4 = data.loadValid('nTotalRight4',0,data.int10);
var nTotalSkipped = data.loadValid('nTotalSkipped',0,data.int10);
var nTotalExp = data.loadValid('nTotalExp',0,data.int10);
// Just for this session
var nAsked = data.loadValid('nAsked',0,data.int10);
var nRight1 = data.loadValid('nRight1',0,data.int10);
var nRight2 = data.loadValid('nRight2',0,data.int10);
var nRight3 = data.loadValid('nRight3',0,data.int10);
var nRight4 = data.loadValid('nRight4',0,data.int10);
var nSkipped = data.loadValid('nSkipped',0,data.int10);
var nExp = data.loadValid('nExp',0,data.int10);

var timer = createTimeQueue();

var GLOBAL = {
	// height = width * aspectRatio / 100
	aspectRatio: 100,
	// time between animated events
	animDelay: 300,
	// the lowest operand to use
	minOp: 0,
	// the highest operand to use
	maxOp: 99
};

onload = function(){
	resizeWindow(GLOBAL.aspectRatio);
	onresize = function(){ resizeWindow(GLOBAL.aspectRatio); };
	document.getElementById('choice-4').onclick = erase;
	showSessionStatsAnalisys();
};
</script>

</body>
</html>

